!function(){var t,e={};function n(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function r(t){for(var e,n=1;n<arguments.length;n++)e=null==arguments[n]?{}:arguments[n],n%2?o(Object(e),!0).forEach(function(n){var i;i=e[n],n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):o(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))});return t}var a={threshold:50,passive:!1};e=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,t),this.options=r(r({},a),i),this.element=null,this.touchStartX=0,this.touchStartY=0,this.touchEndX=0,this.touchEndY=0,this.onSwipeLeftAgent=null,this.onSwipeRightAgent=null,this.onSwipeUpAgent=null,this.onSwipeDownAgent=null,this.onTapAgent=null,this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onSwipeLeft=this.onSwipeLeft.bind(this),this.onSwipeRight=this.onSwipeRight.bind(this),this.onSwipeUp=this.onSwipeUp.bind(this),this.onSwipeDown=this.onSwipeDown.bind(this),this.onTap=this.onTap.bind(this),this.destroy=this.destroy.bind(this),this.handleGesture=this.handleGesture.bind(this);var s=!!this.options.passive&&{passive:!0};this.element=e instanceof EventTarget?e:document.querySelector(e),this.element.addEventListener("touchstart",this.onTouchStart,s),this.element.addEventListener("touchend",this.onTouchEnd,s)}return s(t,[{key:"onTouchStart",value:function(t){this.touchStartX=t.changedTouches[0].screenX,this.touchStartY=t.changedTouches[0].screenY}},{key:"onTouchEnd",value:function(t){this.touchEndX=t.changedTouches[0].screenX,this.touchEndY=t.changedTouches[0].screenY,this.handleGesture()}},{key:"onSwipeLeft",value:function(t){this.onSwipeLeftAgent=t}},{key:"onSwipeRight",value:function(t){this.onSwipeRightAgent=t}},{key:"onSwipeUp",value:function(t){this.onSwipeUpAgent=t}},{key:"onSwipeDown",value:function(t){this.onSwipeDownAgent=t}},{key:"onTap",value:function(t){this.onTapAgent=t}},{key:"destroy",value:function(){this.element.removeEventListener("touchstart",this.onTouchStart),this.element.removeEventListener("touchend",this.onTouchEnd)}},{key:"handleGesture",value:function(){return this.touchEndX+this.options.threshold<=this.touchStartX?(this.onSwipeLeftAgent&&this.onSwipeLeftAgent(),"swiped left"):this.touchEndX-this.options.threshold>=this.touchStartX?(this.onSwipeRightAgent&&this.onSwipeRightAgent(),"swiped right"):this.touchEndY+this.options.threshold<=this.touchStartY?(this.onSwipeUpAgent&&this.onSwipeUpAgent(),"swiped up"):this.touchEndY-this.options.threshold>=this.touchStartY?(this.onSwipeDownAgent&&this.onSwipeDownAgent(),"swiped down"):this.touchEndY===this.touchStartY?(this.onTapAgent&&this.onTapAgent(),"tap"):void 0}}]),t}();var h=function(){function t(e){n(this,t),e?(this.state=e,this.startState=e):(this.state=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.startState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),this.status="idle",this.score=0}return s(t,[{key:"moveLeft",value:function(){var t=[[],[],[],[]],e=[[],[],[],[]];if("playing"===this.getStatus()){for(var n=0;n<4;n++)for(var i=0;i<4;i++)t[n][i]=this.getState()[n][i],e[n][i]=this.getState()[n][i];for(var s=function(t){for(var e=0;e<4;e++)for(var n=0;n<3;n++)0===t[n]&&(t[n]=t[n+1],t[n+1]=0)},o=0;o<4;o++){var r=e[o];s(r);for(var a=0;a<3;a++)r[a]===r[a+1]&&(r[a]=2*r[a],r[a+1]=0,this.setScore(r[a]));s(r),e[o]=r}JSON.stringify(this.getState())!==JSON.stringify(e)&&this.createNewCell(e),this.checkLose(),this.checkWin()}}},{key:"moveRight",value:function(){var t=[[],[],[],[]],e=[[],[],[],[]];if("playing"===this.getStatus()){for(var n=0;n<4;n++)for(var i=0;i<4;i++)t[n][i]=this.getState()[n][i],e[n][i]=this.getState()[n][i];for(var s=function(t){for(var e=3;e>=0;e--)for(var n=3;n>0;n--)0===t[n]&&(t[n]=t[n-1],t[n-1]=0)},o=0;o<4;o++){var r=e[o];s(r);for(var a=3;a>=0;a--)r[a]===r[a-1]&&(r[a]=2*r[a],r[a-1]=0,this.setScore(r[a]));s(r),e[o]=r}JSON.stringify(this.getState())!==JSON.stringify(e)&&this.createNewCell(e),this.checkLose(),this.checkWin()}}},{key:"moveUp",value:function(){var t=[[],[],[],[]];function e(t){for(var e=0;e<4;e++)for(var n=0;n<3;n++)0===t[n]&&(t[n]=t[n+1],t[n+1]=0)}if("playing"===this.getStatus()){for(var n=0;n<4;n++)for(var i=0;i<4;i++)t[n][i]=this.getState()[n][i];for(var s=0;s<4;s++){for(var o=[],r=0;r<4;r++)o[r]=t[r][s];e(o);for(var a=0;a<3;a++)o[a]===o[a+1]&&(o[a]=2*o[a],o[a+1]=0,this.setScore(o[a]));e(o);for(var h=0;h<4;h++)t[h][s]=o[h]}JSON.stringify(this.getState())!==JSON.stringify(t)&&this.createNewCell(t),this.checkLose(),this.checkWin()}}},{key:"moveDown",value:function(){var t=[[],[],[],[]];function e(t){for(var e=3;e>=0;e--)for(var n=3;n>0;n--)0===t[n]&&(t[n]=t[n-1],t[n-1]=0)}if("playing"===this.getStatus()){for(var n=0;n<4;n++)for(var i=0;i<4;i++)t[n][i]=this.getState()[n][i];for(var s=0;s<4;s++){for(var o=[],r=0;r<4;r++)o[r]=t[r][s];e(o);for(var a=0;a<3;a++)o[a]===o[a+1]&&(o[a]=2*o[a],o[a+1]=0,this.setScore(o[a]));e(o);for(var h=0;h<4;h++)t[h][s]=o[h]}JSON.stringify(this.getState())!==JSON.stringify(t)&&this.createNewCell(t),this.checkLose(),this.checkWin()}}},{key:"checkWin",value:function(){for(var t=0;t<4;t++)for(var e=0;e<4;e++)2048===this.getState()[t][e]&&this.setStatus("win")}},{key:"checkLose",value:function(){for(var t=0,e=16,n=0;n<4;n++)for(var i=0;i<4;i++)0!==this.getState()[n][i]&&e--;for(var s=0;s<4;s++)for(var o=0;o<3;o++)this.getState()[s][o]!==this.getState()[s][o+1]&&t++;for(var r=0;r<4;r++)for(var a=0;a<3;a++)this.getState()[a][r]!==this.getState()[a+1][r]&&t++;24===t&&0===e&&this.setStatus("lose")}},{key:"getScore",value:function(){return this.score}},{key:"setScore",value:function(t){this.score=this.getScore()+t}},{key:"resetScore",value:function(){this.score=0}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(t){this.state=t}},{key:"getStatus",value:function(){return this.status}},{key:"setStatus",value:function(t){this.status=t}},{key:"start",value:function(){this.setStatus("playing"),this.makeNewField()}},{key:"restart",value:function(){this.setStatus("idle"),this.setState(this.startState),this.resetScore()}},{key:"makeNewField",value:function(){for(var t=c(),e=c(),n=this.startState.map(function(t){return t.slice()}).flat(1),i=[],s=0;s<n.length;s++)0===n[s]&&i.push(s);if(0!==i.length){for(var o=Math.round(Math.random()*(i.length-1)),r=Math.round(Math.random()*(i.length-1));o===r;)r=Math.round(Math.random()*i.length);n[i[o]]=t,n[i[r]]=e;for(var a=0,h=this.startState.map(function(t){return t.slice()}),u=0;u<4;u++)for(var l=0;l<4;l++)h[u][l]=n[a],a++;this.setState(h)}}},{key:"createNewCell",value:function(t){for(var e=c(),n=t.map(function(t){return t.slice()}).flat(1),i=[],s=0;s<n.length;s++)0===n[s]&&i.push(s);if(0!==i.length){var o=Math.round(Math.random()*(i.length-1));n[i[o]]=e;for(var r=0,a=t.map(function(t){return t.slice()}),h=0;h<4;h++)for(var u=0;u<4;u++)a[h][u]=n[r],r++;this.setState(a)}}}]),t}(),c=function(){return 10*Math.random()>3?2:4},u=new h,l=document.querySelector(".game-score"),f=document.querySelector("button"),d=document.querySelector(".message-start"),v=document.querySelector(".message-win"),S=document.querySelector(".message-lose");function g(){var t=document.querySelectorAll("td"),e=u.getState().map(function(t){return t.slice()}).flat(1);t[0].setAttribute("class","");try{for(var n=0;n<16;n++)t[n].setAttribute("class",""),t[n].textContent="",0===e[n]?t[n].classList.add("field-cell"):(t[n].classList.add("field-cell"),t[n].classList.add("field-cell--".concat(e[n])),t[n].textContent=e[n])}catch(t){}l.textContent=u.getScore(),function(){switch(u.getStatus()){case"idle":d.classList.remove("hidden"),v.classList.add("hidden"),S.classList.add("hidden");break;case"playing":d.classList.add("hidden"),v.classList.add("hidden"),S.classList.add("hidden");break;case"win":d.classList.add("hidden"),v.classList.remove("hidden"),S.classList.add("hidden");break;case"lose":d.classList.add("hidden"),v.classList.add("hidden"),S.classList.remove("hidden")}}()}g(),function t(){f.addEventListener("click",function(){f.classList.remove("start"),f.classList.add("restart"),u.start(),g(),f.addEventListener("click",function(){f.classList.add("start"),f.classList.remove("restart"),u.restart(),g(),t()})})}(),document.querySelector("html").addEventListener("keydown",function(t){switch(t.key){case"ArrowUp":u.moveUp();break;case"ArrowDown":u.moveDown();break;case"ArrowLeft":u.moveLeft();break;case"ArrowRight":u.moveRight()}g()}),document.querySelector(".move-up").addEventListener("click",function(){u.moveUp(),g()}),document.querySelector(".move-down").addEventListener("click",function(){u.moveDown(),g()}),document.querySelector(".move-left").addEventListener("click",function(){u.moveLeft(),g()}),document.querySelector(".move-right").addEventListener("click",function(){u.moveRight(),g()});var p=document.querySelector("html"),w=new((t=e)&&t.__esModule?t.default:t)(p);w.onSwipeUp(function(){u.moveUp(),g()}),w.onSwipeDown(function(){u.moveDown(),g()}),w.onSwipeLeft(function(){u.moveLeft(),g()}),w.onSwipeRight(function(){u.moveRight(),g()})}();
//# sourceMappingURL=index.1f12807b.js.map
